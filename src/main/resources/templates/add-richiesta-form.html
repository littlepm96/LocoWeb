<html lang="en" xmlns:th="http://www.thymeleaf.org">

<style>
	form {
        /* Form centrato nella pagina */
        margin: 0 auto;
        width: 500px;
        /* Linee intorno al Form */
        padding: 1em;
        border: 3px solid #ccc;
        border-radius: 1em;
    }
</style>

<head>
    <title>Inserisci Richiesta</title>

    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
          integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
          crossorigin="anonymous"/>
</head>
<body>

<div class="container">

    <h3 class="text-center">Inserisci la tua richiesta</h3>
    <hr/>

    <form th:action="@{/saveRichiesta}" th:object="${richiesta}" method="POST">
        <div class="form-group">
            <label>Nome</label>
            <input type="text" maxlength="10" th:field="*{nome}" id="nome" class="form-control col-40 mb-4" placeholder="inserisci nome"/>
        </div>
        <div class="form-group">
            <label> Cognome </label>
            <input type="text" maxlength="10" th:field="*{cognome}" id="cognome" class="form-control col-40 mb-4" placeholder="inserisci cognome"/>
        </div>
        <div class="form-group">
            <label> Email </label>
            <input type="text" maxlength="20" th:field="*{email}" id="email" class="form-control col-40 mb-4" placeholder="inserisci email"/>
        </div>
        <div class="form-group">
            <label> Cellulare </label>
            <input type="text" maxlength="10" th:field="*{cellulare}" id="cellulare" class="form-control col-40 mb-4" placeholder="inserisci cellulare"/>
        </div>
        <div class="form-group">
            <label> Descrizione </label>
            <textarea type="text" maxlength="200" th:field="*{descrizione}" id="descrizione" class="form-control col-40 mb-4" placeholder="inserisci richiesta"/> </textarea>
        </div>

        <button type="submit" class="btn btn-primary col-4">Inoltra Form</button>

        <input type="hidden" th:field="*{id}"/>
    </form>
    <hr/>
    <a class="d-block text-center" th:href="@{/}">Back to homepage</a>

    <!-- Toast Area Start -->
    <div id="successToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <img src="..." class="rounded mr-2" alt="...">
            <strong class="mr-auto">Bootstrap</strong>
            <small>Now</small>
            <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="toast-body">
            Richiesta inserita correttamente. Tornare alla homepage!
        </div>
    </div>
    <div id="failureToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <img src="..." class="rounded mr-2" alt="...">
            <strong class="mr-auto">Bootstrap</strong>
            <small>Now</small>
            <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="toast-body">
            Errore nell'inserimento della richiesta.
        </div>
    </div>
    <!-- Toast Area End -->
</div>

<script>
    $('button[type="submit"]').click(function (event) {
        event.preventDefault();

        $.post("/saveRichiesta", {
            'nome': $('#nome').val(),
            'cognome': $('#cognome').val(),
            'email': $('#email').val(),
            'cellulare': $('#cellulare').val(),
            'descrizione': $('#descrizione').val()
        }, function (response) {
            if (response) {
                $('#successToast').toast('show');
            } else {
                $('#failureToast').toast('show');
            }
        });
    });
</script>
</body>
</html>